language: go

go:
  - 1.3.3
  - 1.4.1

env:
  - GIMME_OS=linux GIMME_ARCH=amd64
  - GIMME_OS=darwin GIMME_ARCH=amd64
  - GIMME_OS=windows GIMME_ARCH=amd64

# let us have speedy Docker-based Travis workers
sudo: false

install:
  - export GOPATH=${TRAVIS_BUILD_DIR}/Godeps/_workspace:$GOPATH
  - export PATH=${TRAVIS_BUILD_DIR}/Godeps/_workspace/bin:$PATH
  - go get code.google.com/p/go.tools/cmd/vet

script:
  - script/validate-dco
  - script/validate-gofmt
  - go vet ./...
  - if [ "$(go env GOOS)" = "$(go env GOHOSTOS)" ]; then
      go test -v -race ./... ;
    else
      go build -v ./... ;
    fi
